version: '3.8'

services:
  build:
    image: node:18-alpine
    container_name: hover-extension-build
    volumes:
      - .:/app
    working_dir: /app
    command: sh -c "npm install && npm run build"
    environment:
      - NODE_ENV=production
    network_mode: 'host'

  dev:
    image: node:18-alpine
    container_name: hover-extension-dev
    volumes:
      - .:/app
    working_dir: /app
    command: sh -c "npm install && npm run dev"
    environment:
      - NODE_ENV=development
    network_mode: 'host'
    ports:
      - '9000:9000' # For any dev server if needed

  test:
    image: node:18-alpine
    container_name: hover-extension-test
    volumes:
      - .:/app
    working_dir: /app
    command: sh -c "npm install && npm test"
    environment:
      - NODE_ENV=test
    network_mode: 'host'

  package:
    image: node:18-alpine
    container_name: hover-extension-package
    volumes:
      - .:/app
    working_dir: /app
    command: sh -c "npm install && npm run build && npm run package"
    environment:
      - NODE_ENV=production
    network_mode: 'host'
